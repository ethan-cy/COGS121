<html>
<head>
  <title>MedicineApp</title>

  <script src="jquery-3.4.0.min.js"></script>
  <link rel="stylesheet" type="text/css" href="prescription.css">
  <!-- <link href="https://fonts.googleapis.com/css?family=Gugi" rel="stylesheet"> -->
  <link href="https://fonts.googleapis.com/css?family=Hind+Madurai&display=swap" rel="stylesheet">
  <!-- The core Firebase JS SDK is always required and must be listed first -->
  <script src="https://www.gstatic.com/firebasejs/6.1.0/firebase.js"></script>
  <script>
  // Your web app's Firebase configuration
  var firebaseConfig = {
    apiKey: "AIzaSyAwBNshPstMv4gkbTYYZxklVdUh6neHQnc",
    authDomain: "cogs121doseinfo.firebaseapp.com",
    databaseURL: "https://cogs121doseinfo.firebaseio.com",
    projectId: "cogs121doseinfo",
    storageBucket: "cogs121doseinfo.appspot.com",
    messagingSenderId: "297528001615",
    appId: "1:297528001615:web:b9c799c375583153"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  </script>

  <script type="text/javascript">
  $(document).ready(() => {
    const database = firebase.database();
    var currUser = "billwill"; //FILL  IN
    $('#getInfoButton').click(() => {
      const key = currUser + '/prescriptions/'+ $('#userPrescriptions').val();
      database.ref(key).once('value', (snapshot) => {
        const drug = snapshot.val();
        if(drug == null){
            $('#msgBox').html('Please enter a valid name.');
        }
        console.log(drug);
        $('#drugName').html('Name: ' + drug.drugName);
        $('#drugRec').html('Recommended Dosage: ' + drug.recDose);
        $('#drugNote').html("Consume Every: " + drug.consumptionTime);
        $('#drugNote').html("Special Note: " + drug.notes);

      });
    });
    //go through user prescription
    database.ref(currUser).once('value', (snapshot) => {
      console.log("got user object");
      var listOfPrescriptions = snapshot.val().prescriptions;
      console.log("got list of prescriptions: " + listOfPrescriptions);
      for(var key in listOfPrescriptions){
        console.log("key = " + key);
        var selectTag = document.getElementById('userPrescriptions');
        console.log("selecTag = " + selectTag);
        selectTag.options[selectTag.options.length] = new Option(key, key.drugName);
      }
    });
  });

</script>

</head>
<body>
  <h1>Prescription Renewal</h1>


    <select id="userPrescriptions">
          <option value="">--Please choose an option--</option>
    </select>
    <br>
    <button id="getInfoButton" class="input2">Find Information</button>

  <div id="msgBox">
    <div id="drugName"></div>
    <div id="drugRec"></div>
    <div id="drugTime"></div>
    <div id="drugNote"></div>
  </div>

  <footer id="navbar">
    <a href="./main.html" id="home"><img src="./icons/heartbeat.png" alt="heart rate icon"/><p>Home</p></a>
    <a href="./drugdosage.html" id="prescribe"><img src="./icons/pillbottle.png" alt="prescription icon"/><p>Prescription</p> </a>
    <a href="./information.html" id="information"><img src="./icons/pills.png" alt="information icon"/><p>Information</p> </a>
    <a href="./heartrate.html" id="heartrate"><img src="./icons/heartbeat.png" alt="heart rate icon" /><p>Heart Rate</p></a>
    <a href="./account.html" id="account"><img src="./icons/user.png" alt="user icon" /><p>My Account</p></a>
  </footer>

</body>
</html>
